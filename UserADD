#List of users to be added
$users = @("Brian Dawi", "The Terminator", "Happy Gilmore", "Jason Bourne", "James Smith")

#List of groups to add users to
$groups = @("Administrators", "Schema Admins", "Enterprise Admins", "Domain Admins", "Group Policy Creator Owners")

forEach ($user in $users) {

   Try {

       #Trying to add new AD User from array
        new-aduser -Name $user -AccountPassword $Password
        Write-Host "New User $user was added"

   } catch {

       #If adding user fails, throw this error
        "Failed to add new user $user"

   }
    
    #Loop through groups array
    forEach ($group in $groups) {


       Try {

           #Add newly created users to all groups in groups array
            Add-ADPrincipalGroupMembership -Identity $user -MemberOf $group  

       }catch{

           #If adding fails throw this error
            "Failed to add $user to $group!"

       }

   }

   Try {
     
        #Enable each account we have just created
        Enable-ADAccount -Identity $user

   }
    catch {

       #If enabling account fails, throw this error
        "Failed to enable $user account"

   }
}
